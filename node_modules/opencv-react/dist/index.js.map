{"version":3,"file":"index.js","sources":["../src/lib/OpenCvProvider.js","../src/lib/useOpenCv.js"],"sourcesContent":["import * as React from 'react'\n\nconst OpenCvContext = React.createContext()\n\nconst { Consumer: OpenCvConsumer, Provider } = OpenCvContext\n\nexport { OpenCvConsumer, OpenCvContext }\n\nconst scriptId = 'opencv-react'\nconst moduleConfig = {\n  wasmBinaryFile: 'opencv_js.wasm',\n  usingWasm: true\n}\n\nexport const OpenCvProvider = ({ openCvVersion = '3.4.16', openCvPath = '', children }) => {\n  const [cvInstance, setCvInstance] = React.useState({ loaded: false, cv: undefined });\n\n  React.useEffect(() => {\n    if (document.getElementById(scriptId) || window.cv) {\n      return\n    }\n\n    // https://docs.opencv.org/3.4/dc/de6/tutorial_js_nodejs.html\n    // https://medium.com/code-divoire/integrating-opencv-js-with-an-angular-application-20ae11c7e217\n    // https://stackoverflow.com/questions/56671436/cv-mat-is-not-a-constructor-opencv\n    moduleConfig.onRuntimeInitialized = () => {\n      setCvInstance({ loaded: true, cv: window.cv });\n    }\n    window.Module = moduleConfig\n\n    const generateOpenCvScriptTag = () => {\n      const js = document.createElement('script')\n      js.id = scriptId\n      js.src = openCvPath || `https://docs.opencv.org/${openCvVersion}/opencv.js`\n\n      js.nonce = true\n      js.defer = true\n      js.async = true\n\n      return js\n    }\n\n    document.body.appendChild(generateOpenCvScriptTag())\n  }, [openCvPath, openCvVersion])\n\n  return (\n    <Provider value={cvInstance}>\n      {children}\n    </Provider>\n  )\n}\n","import * as React from 'react'\nimport { OpenCvContext } from './OpenCvProvider'\n\nexport const useOpenCv = () => React.useContext(OpenCvContext)\n"],"names":["OpenCvContext","React","OpenCvConsumer","Consumer","Provider","scriptId","moduleConfig","wasmBinaryFile","usingWasm","OpenCvProvider","openCvVersion","openCvPath","children","loaded","cv","undefined","cvInstance","setCvInstance","document","getElementById","window","onRuntimeInitialized","Module","generateOpenCvScriptTag","js","createElement","id","src","nonce","defer","async","body","appendChild","React.createElement","useOpenCv"],"mappings":";;IAEMA,aAAa,GAAGC,mBAAA;IAEJC,iBAA6BF,cAAvCG;IAA0BC,WAAaJ,cAAbI;AAIlC,IAAMC,QAAQ,GAAG,cAAjB;AACA,IAAMC,YAAY,GAAG;AACnBC,EAAAA,cAAc,EAAE,gBADG;AAEnBC,EAAAA,SAAS,EAAE;AAFQ,CAArB;IAKaC,cAAc,GAAG,SAAjBA,cAAiB,OAA6D;AAAA,gCAA1DC,aAA0D;AAAA,MAA1DA,aAA0D,mCAA1C,QAA0C;AAAA,6BAAhCC,UAAgC;AAAA,MAAhCA,UAAgC,gCAAnB,EAAmB;AAAA,MAAfC,QAAe,QAAfA,QAAe;;AAAA,wBACrDX,cAAA,CAAe;AAAEY,IAAAA,MAAM,EAAE,KAAV;AAAiBC,IAAAA,EAAE,EAAEC;AAArB,GAAf,CADqD;AAAA,MAClFC,UADkF;AAAA,MACtEC,aADsE;;AAGzFhB,EAAAA,eAAA,CAAgB,YAAM;AACpB,QAAIiB,QAAQ,CAACC,cAAT,CAAwBd,QAAxB,KAAqCe,MAAM,CAACN,EAAhD,EAAoD;AAClD;AACD;;AAKDR,IAAAA,YAAY,CAACe,oBAAb,GAAoC,YAAM;AACxCJ,MAAAA,aAAa,CAAC;AAAEJ,QAAAA,MAAM,EAAE,IAAV;AAAgBC,QAAAA,EAAE,EAAEM,MAAM,CAACN;AAA3B,OAAD,CAAb;AACD,KAFD;;AAGAM,IAAAA,MAAM,CAACE,MAAP,GAAgBhB,YAAhB;;AAEA,QAAMiB,uBAAuB,GAAG,SAA1BA,uBAA0B,GAAM;AACpC,UAAMC,EAAE,GAAGN,QAAQ,CAACO,aAAT,CAAuB,QAAvB,CAAX;AACAD,MAAAA,EAAE,CAACE,EAAH,GAAQrB,QAAR;AACAmB,MAAAA,EAAE,CAACG,GAAH,GAAShB,UAAU,iCAA+BD,aAA/B,eAAnB;AAEAc,MAAAA,EAAE,CAACI,KAAH,GAAW,IAAX;AACAJ,MAAAA,EAAE,CAACK,KAAH,GAAW,IAAX;AACAL,MAAAA,EAAE,CAACM,KAAH,GAAW,IAAX;AAEA,aAAON,EAAP;AACD,KAVD;;AAYAN,IAAAA,QAAQ,CAACa,IAAT,CAAcC,WAAd,CAA0BT,uBAAuB,EAAjD;AACD,GA1BD,EA0BG,CAACZ,UAAD,EAAaD,aAAb,CA1BH;AA4BA,sBACEuB,oBAAC,QAAD;AAAU,IAAA,KAAK,EAAEjB;AAAjB,KACGJ,QADH,CADF;AAKD;;IC/CYsB,SAAS,GAAG,SAAZA,SAAY;AAAA,SAAMjC,gBAAA,CAAiBD,aAAjB,CAAN;AAAA,CAAlB;;;;;;;"}